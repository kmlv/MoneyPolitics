{% extends "global/Page.html" %}
{% load staticfiles otree_tags %}
{% load i18n %}

{% block title %}
Juego de transcripción
{% endblock %}

{% block content %}

<style>

    .main-containter{
        width: 100%;
        height: 100vh;
        background: #fff;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .box1{
        display: flex;
        align-items: center;
    }
    .intext11, #intext2{
        width: 600px;
        font-size: 20px;
        font-weight: 600;
        height: 55px;
        text-align: center;

        background: #fff;

    }
    .add-s{
        margin: 13px 20px 12px 21px;
        font-size: 25px;
    }

    .btn{
        padding: 8px 20px;
        border: none;
        font-size: 16px;
        color: #fff;
        background: #fb6868;

        border-bottom-left-radius: 10px;
        border-bottom-right-radius: 10px;
    }
</style>

<input class = "field" id = "transcription_1" name = "transcription_1" hidden>
<input class = "field" id = "transcription_2" name = "transcription_2" hidden>
<input class = "field" id = "transcription_3" name = "transcription_3" hidden>
<input class = "field" id = "transcription_4" name = "transcription_4" hidden>
<input class = "field" id = "transcription_5" name = "transcription_5" hidden>
<input class = "field" id = "transcription_6" name = "transcription_6" hidden>
<input class = "field" id = "transcription_7" name = "transcription_7" hidden>
<input class = "field" id = "transcription_8" name = "transcription_8" hidden>
<input class = "field" id = "transcription_9" name = "transcription_9" hidden>
<input class = "field" id = "transcription_10" name = "transcription_10" hidden>

<input class = "correct_answer" id = "transcription_1_correct" name = "transcription_1_correct" hidden>
<input class = "correct_answer" id = "transcription_2_correct" name = "transcription_2_correct" hidden>
<input class = "correct_answer" id = "transcription_3_correct" name = "transcription_3_correct" hidden>
<input class = "correct_answer" id = "transcription_4_correct" name = "transcription_4_correct" hidden>
<input class = "correct_answer" id = "transcription_5_correct" name = "transcription_5_correct" hidden>
<input class = "correct_answer" id = "transcription_6_correct" name = "transcription_6_correct" hidden>
<input class = "correct_answer" id = "transcription_7_correct" name = "transcription_7_correct" hidden>
<input class = "correct_answer" id = "transcription_8_correct" name = "transcription_8_correct" hidden>
<input class = "correct_answer" id = "transcription_9_correct" name = "transcription_9_correct" hidden>
<input class = "correct_answer" id = "transcription_10_correct" name = "transcription_10_correct" hidden>

<div class="main-container">
    <div class="main">
        <div class="main-box">
            <p> Trascribe el siguiente texto en el recuadro en blanco.</p>
            <p> Trata de ser exacto y asegúrate de poner todas las caracteres correspondientes.</p>
    
            <div class="show-answer"><span id="ans"></span></div>
            <div class="box1">
                <div onmousedown="return false" onselectstart="return false" class="box-col">
                    <input type="textf" id="id" class="intext11" disabled  ><br>
                </div>
                <br>
            </div>
            <br>

        </div>

        <div class="box-col">
            <input type="text" id="intext2">
        </div>
        <br>
        <div class="box2">
            <button class="button" type="button" onclick="Game()">Submit Answer</button>
        </div>

    </div>
</div>



<script>

// dec2hex :: Integer -> String
// i.e. 0-255 -> '00'-'ff'
document.onselectstart = new Function("return false")
var alphabet = "abcdefghijklmnopqrstuvwxyz"
var randomCharacter = alphabet[Math.floor(Math.random() * alphabet.length)]
function dec2hex (dec) {
    var random = Math.floor(Math.random() * 3)
    if (random == 1){
        return dec.toString(20).padStart(2, randomCharacter)
    } else if (random == 2) {
        return dec.toString(16).padStart(3, randomCharacter)
    } else {
        return dec.toString(30).padStart(4, randomCharacter)
    }
}

// generateId :: Integer -> String
function generateId (len) {
  var arr = new Uint8Array((len || 40) / 4)
  window.crypto.getRandomValues(arr)
  return Array.from(arr, dec2hex).join('.')
}
var field = $(".field");
var correct_answer = $(".correct_answer");
let score = 0
let id = generateId(40)
id = id.toString()
document.getElementById("id").value = id;
$(correct_answer[0]).val(id);

function Game(){
    let user = document.getElementById("intext2").value;
    user = user.toString()
    $(field[score]).val(user);
        if( user == id ){
            document.getElementById("ans").innerHTML = "Your answer was correct"
        } else {
            document.getElementById("ans").innerHTML = "Your transcription was incorrect"
        }
         
        user = document.getElementById("intext2").value = "";
        id = generateId(40)
        id = id.toString()
        document.getElementById("id").value = id;
        $(correct_answer[score+1]).val(id);
        ++score 
}

</script>
<br><br>

{% next_button %}



{% endblock %}